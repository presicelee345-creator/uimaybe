{% extends "ncbw/base.html" %}
{% block content %}
<nav>
  <span class="logo">NC100BW Training</span>
  <div class="nav-links">
    <span style="color:#888; font-size:13px;">{{ user.first_name }} {{ user.last_name }}</span>
    <a href="{% url 'logout' %}">Logout</a>
  </div>
</nav>

<div style="max-width:900px; margin:0 auto; padding:30px 20px;">

  <!-- Header -->
  <div class="card" style="margin-bottom:24px;">
    <div style="display:flex; justify-content:space-between; align-items:flex-start; flex-wrap:wrap; gap:16px;">
      <div>
        <h2 style="font-size:22px; color:#B8860B;">{{ track.name }} Training</h2>
        <p style="color:#888; margin-top:6px; font-size:14px;">{{ track.description }}</p>
      </div>
      <div style="text-align:right; min-width:140px;">
        <div style="font-size:28px; font-weight:bold; color:#B8860B;">{{ overall }}%</div>
        <div style="color:#888; font-size:12px; margin-bottom:8px;">Overall Progress</div>
        <div class="progress-bar" style="width:140px;">
          <div class="progress-fill" style="width:{{ overall }}%;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modules -->
  <h3 style="margin-bottom:16px; color:#ccc;">Training Modules</h3>
  {% for attr in attributes %}
  {% with mi=forloop.counter0 %}
  {% with mod_prog=modules|default_if_none:"{}" %}
  <div class="card" style="margin-bottom:14px;">
    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px;">
      <div style="flex:1;">
        <div style="display:flex; align-items:center; gap:10px; margin-bottom:6px;">
          <span style="background:#333; color:#B8860B; border-radius:50%; width:28px; height:28px; display:inline-flex; align-items:center; justify-content:center; font-size:13px; font-weight:bold;">{{ forloop.counter }}</span>
          <h4 style="font-size:16px;">{{ attr.title }}</h4>
        </div>
        <p style="color:#888; font-size:13px; margin-left:38px;">{{ attr.description }}</p>
        <p style="color:#666; font-size:12px; margin-left:38px; margin-top:4px;">{{ attr.courses|length }} courses &nbsp;Â·&nbsp; Quiz: {{ attr.quiz.duration }}</p>
      </div>
      <a href="{% url 'module_detail' track_id mi %}" class="btn btn-gold" style="white-space:nowrap;">View Module</a>
    </div>
  </div>
  {% endwith %}
  {% endwith %}
  {% endfor %}

</div>
{% endblock %}
